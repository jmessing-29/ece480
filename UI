import tkinter as tk
from tkinter import *
from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg
import matplotlib.pyplot as plt
from matplotlib.figure import Figure
import matplotlib.animation as animation
import time
import numpy as np


# Create the main window
root = tk.Tk()
root.title("Contaminant Sensing")

# Set window dimensions to full screen dimensions
screen_width = root.winfo_screenwidth()
screen_height = root.winfo_screenheight()
root.geometry(f"{screen_width}x{screen_height}")
root.attributes('-topmost', True)


root.config(bg="skyblue")

# Create a matplotlib figure and axis
fig = plt.figure(figsize=(6, 4))
ax = fig.add_subplot(111)
# ax.set_xlim(0, 10)
# ax.set_ylim(0, 1)
line, = ax.plot([], [])
ax.set_title("Contaminant Sensing")
ax.set_xlabel("Time")
ax.set_ylabel("Concentration")
canvas = FigureCanvasTkAgg(fig, master=root)
canvas_widget = canvas.get_tk_widget()
canvas_widget.pack()

x_data = []
y_data = []

animation_running = False

def update_plot():
    if animation_running:
      x_data.append(len(x_data))
      y_data.append(np.random.random())
      line.set_data(x_data, y_data)
      
      # Dynamically adjust the x and y axis limits based on data
      ax.relim()
      ax.autoscale_view(tight=True)
      
      canvas.draw()
      root.after(500, update_plot)  # Update every half second

def start_animation():
    global animation_running
    animation_running = True
    update_plot()

def stop_animation():
    global animation_running
    animation_running = False

# Start the animation
start_button = Button(root, text="Start Experiment", command=lambda: start_animation() if not animation_running else None)
start_button.pack()
stop_button = Button(root, text="Stop Experiment", command=lambda: stop_animation() if animation_running else None)
stop_button.pack()
# update_plot()

# Start the tkinter main loop
root.mainloop()
